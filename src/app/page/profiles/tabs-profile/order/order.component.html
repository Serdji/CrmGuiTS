<div class="order">
  <mat-card *ngIf="progress">
    <mat-progress-bar mode="buffer"></mat-progress-bar>
  </mat-card>
  <mat-accordion *ngIf="!progress" multi="true">
    <mat-expansion-panel *ngFor="let order of orders; let i = index" [expanded]="i === 0">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <span>Заказ №&nbsp;</span>
          <span><b>{{order.recloc}}</b></span>
        </mat-panel-title>
        <mat-panel-description>
          <span>Статус заказа:&nbsp;</span>
          <span><b>{{order.BookingStatus | fieldTranslation}}</b></span>
        </mat-panel-description>
        <mat-panel-description  class="_data">
          <span>Дата создания:&nbsp;</span>
          <span><b>{{order.lut | date:'dd.MM.yyyy'}}</b></span>
        </mat-panel-description>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent>
        <div class="order__grid-wrapper">
          <div class="order__grid">
            <mat-grid-list *ngFor=" let pos of order.pos" cols="1" rowHeight="149px">
              <mat-grid-tile [colspan]="1" [rowspan]="1">
                <mat-card class="order__card-grid _ticket mat-elevation-z0">
                  <div class="order__content-wrapper">
                    <div class="order__content">
                      <div class="order__content-ticket"><b>Recloc GDS:</b> {{pos.distrRecloc.recloc}}</div>
                      <div class="order__content-ticket"><b>GDS:</b> {{pos.gds}}</div>
                      <div class="order__content-ticket"><b>POS ID:</b> {{pos.posId}}</div>
                    </div>

                    <div class="order__content">
                      <div class="order__content-ticket"><b>Агентство:</b> {{pos.agency}}</div>
                      <div class="order__content-ticket"><b>Терминал:</b> {{pos.termId}}</div>
                      <div class="order__content-ticket"><b>Страна:</b> {{pos.country}}</div>
                    </div>
                  </div>
                </mat-card>
              </mat-grid-tile>


              <mat-grid-tile *ngFor=" let segment of order.segments" [colspan]="1" [rowspan]="1">
                <mat-card class="order__card-grid mat-elevation-z0">
                  <div class="order__content-wrapper">
                    <div class="order__content _right-width">
                      <div class="order__content-point">
                        <span class="order__content-text">Аэропорт вылета:</span>
                        <span><b> {{segment.depPoint}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Дата / время вылета:</span>
                        <span><b> {{segment.depTime | date:'hh:mm dd.MM.yyyy'}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Аэропорт прилета:</span>
                        <span><b> {{segment.arrPoint}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Дата / время прилета:</span>
                        <span><b> {{segment.arrTime | date:'hh:mm dd.MM.yyyy'}}</b></span>
                      </div>
                    </div>

                    <div class="order__content">
                      <div class="order__content-point">
                        <span class="order__content-text">№ рейса:</span>
                        <span><b> {{segment.flight}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Кабина:</span>
                        <span><b> {{segment.cabin}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">RBD:</span>
                        <span><b> {{segment.rbd}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Статус сегмента:</span>
                        <span><b> {{segment.status}}</b></span>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </mat-grid-tile>
            </mat-grid-list>
          </div>


          <div class="order__grid">
            <mat-grid-list cols="1" rowHeight="149px">
              <mat-grid-tile [colspan]="1" [rowspan]="1">
                <mat-card class="order__card-grid _ticket mat-elevation-z0">
                  <div class="order__content-wrapper">
                    <div class="order__content _none-justify">
                      <div class="order__content-ticket"><b>Стоимость в валюте:</b></div>

                      <div *ngFor="let MonetaryInfo of order.MonetaryInfo">
                        <div *ngIf="MonetaryInfo.Code === 'TG'" class="order__content-point">
                          <span class="order__content-text">Всего по заказу:</span>
                          <span><b>
                            {{ MonetaryInfo.Amount | currency:MonetaryInfo.Currency:'symbol-narrow'}} |
                            {{ MonetaryInfo.AmountCur | currency:'RUB':'symbol-narrow'}} |
                            {{ MonetaryInfo.AmountEur | currency:'EUR':'symbol-narrow'}} |
                            {{ MonetaryInfo.AmountUsd | currency:'USD':'symbol-narrow'}}
                          </b></span>
                        </div>
                        <div *ngIf="MonetaryInfo.Code === 'TE' || MonetaryInfo.Code === 'TB'" class="order__content-point">
                          <span class="order__content-text">Таксы и сборы:</span>
                          <span><b>
                            {{ MonetaryInfo.Amount | currency:MonetaryInfo.Currency:'symbol-narrow'}} |
                            {{ MonetaryInfo.AmountCur | currency:'RUB':'symbol-narrow'}} |
                            {{ MonetaryInfo.AmountEur | currency:'EUR':'symbol-narrow'}} |
                            {{ MonetaryInfo.AmountUsd | currency:'USD':'symbol-narrow'}}
                          </b></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </mat-grid-tile>

              <mat-grid-tile *ngFor="let ticket of order.tickets" [colspan]="1" [rowspan]="1">
                <mat-card class="order__card-grid mat-elevation-z0">
                  <div class="order__content-wrapper">
                    <div class="order__content _right-width">
                      <div class="order__content-point">
                        <span class="order__content-text">Номер билета:</span>
                        <span><b> {{ticket.ticket}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Аэропорт вылета:</span>
                        <span><b> {{ticket.segment?.depPoint}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Дата / время вылета:</span>
                        <span><b> {{ticket.segment?.depTime | date:'hh:mm dd.MM.yyyy'}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Аэропорт прилета:</span>
                        <span><b> {{ticket.segment?.arrPoint}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Дата / время прилета:</span>
                        <span><b> {{ticket.segment?.arrTime | date:'hh:mm dd.MM.yyyy'}}</b></span>
                      </div>
                    </div>

                    <div class="order__content">
                      <div class="order__content-point">
                        <span class="order__content-text">Номер купона:</span>
                        <span><b> {{ticket.coupon}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">№ рейса:</span>
                        <span><b> {{ticket.segment?.flight}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Fare basis:</span>
                        <span><b> {{ticket.FareCode}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Статус:</span>
                        <span><b> {{ticket.couponStatus}}</b></span>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </mat-grid-tile>
            </mat-grid-list>
          </div>


          <div class="order__grid">
            <mat-grid-list cols="1" rowHeight="224px">
              <mat-grid-tile *ngFor=" let service of order.services" [colspan]="1" [rowspan]="1">
                <mat-card class="order__card-grid mat-elevation-z0">
                  <div class="order__content-wrapper">
                    <div class="order__content _right-width">
                      <div class="order__content-point">
                        <span class="order__content-text">Тип SVC:</span>
                        <span><b>  {{ service.emdType}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Аэропорт вылета:</span>
                        <span><b> {{service.segment?.depPoint}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Дата / время вылета:</span>
                        <span><b> {{service.segment?.depTime | date:'hh:mm dd.MM.yyyy'}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Аэропорт прилета:</span>
                        <span><b> {{service.segment?.arrPoint}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Дата / время прилета:</span>
                        <span><b> {{service.segment?.arrTime | date:'hh:mm dd.MM.yyyy'}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">№ рейса:</span>
                        <span><b> {{service.segment?.flight}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Статус услуги:</span>
                        <span><b> {{service.status}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Стоимость:</span>
                        <span><b>
                          {{ service.emd?.amount | currency:service.emd?.Currency:'symbol-narrow'}} |
                          {{ service.emd?.AmountCur | currency:'RUB':'symbol-narrow'}}
                        </b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">{{ service.nos ? 'Название услуги:' : 'Комментарий:'}}</span>
                        <span><b> {{ service.nos || service.text }}</b></span>
                      </div>
                    </div>

                    <div class="order__content">
                      <div class="order__content-point">
                        <span class="order__content-text">Дата:</span>
                        <span><b> ...</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Rfisc:</span>
                        <span><b> {{service.rfisc}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">SSR:</span>
                        <span><b> {{service.ssr}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Тип EMD:</span>
                        <span><b> {{service.emdType}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Номер купона:</span>
                        <span><b> {{service.emd?.coupon}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Статус:</span>
                        <span><b> {{service.couponStatus}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">EMD:</span>
                        <span><b> {{service.emd?.num}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Количество:</span>
                        <span><b> {{service.qtty}}</b></span>
                      </div>
                      <div class="order__content-point">
                        <span class="order__content-text">Концепт/мера:</span>
                        <span><b> ...</b></span>
                      </div>
                    </div>
                  </div>
                </mat-card>
              </mat-grid-tile>
            </mat-grid-list>
          </div>
        </div>
      </ng-template>
    </mat-expansion-panel>
  </mat-accordion>
</div>
